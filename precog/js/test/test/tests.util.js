var should = require('should'),
	  precog = require('../../src/precog.amd.js');

describe("ajax", function() {
  describe("simple GET", function() {
    it("should load content from url", function(done) {
        precog.util.ajax({
          hostname : "google.com"
        }).then(
            function(result) {
              result.should.include("google.com");
              done();
            },
            function(err) {
              should.fail();
              done();
            }
        );
    });
  });

  describe("https GET", function() {
    it("should load content from secure url", function(done) {
        precog.util.ajax({
          hostname : "encrypted.google.com"
        }).then(
            function(result) {
              result.should.include("google.com");
              done();
            },
            function(err) {
              should.fail();
              done();
            }
        );
    });
  });

  describe("wrong url", function() {
    it("should fail loading url and report an error", function(done) {
        precog.util.ajax({
          hostname : "google.comm" // fake URL
        }).then(
            function(result) {
              should.fail();
              done();
            },
            function(err) {
              should.exist(err);
              done();
            }
        );
    });
  });
});